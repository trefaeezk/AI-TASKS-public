# ูุธุงู ุญุฐู ุงููุณุชุฎุฏููู ุงูุดุงูู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุตููู ูุธุงู ุญุฐู ุงููุณุชุฎุฏููู ููููุฑ ุญุฐูุงู ุดุงููุงู ูุขููุงู ูููุณุชุฎุฏููู ูุน ุฌููุน ุจูุงูุงุชูู ุงููุฑุชุจุทุฉ. ูุฏุนู ุงููุธุงู ููุงู ูู ุงููุณุชุฎุฏููู ุงูุฃูุฑุงุฏ ูุงูุชูุธููููู ูุน ูุฑุงุนุงุฉ ุงููููุฏ ุงูุฃูููุฉ ูุงูุชุญุฐูุฑุงุช ุงูููุงุณุจุฉ.

## ๐๏ธ ูููู ุงููุธุงู

### 1. ุฏูุงู Backend (Firebase Functions)

#### `deleteUserCompletely`
- **ุงููููุน**: `functions/src/userDeletion.ts`
- **ุงููุตู**: ุฏุงูุฉ ุดุงููุฉ ูุญุฐู ุงููุณุชุฎุฏู ูุฌููุน ุจูุงูุงุชู
- **ุงููุนุงููุงุช**:
  - `userId`: ูุนุฑู ุงููุณุชุฎุฏู ุงููุฑุงุฏ ุญุฐูู
  - `forceDelete`: ุญุฐู ูุณุฑู (ุงุฎุชูุงุฑู)

#### `deleteIndividualUserData`
- **ุงููููุน**: `functions/src/individual/index.ts`
- **ุงููุตู**: ุญุฐู ุจูุงูุงุช ุงููุณุชุฎุฏู ุงููุฑุฏู ููุท (ุจุฏูู ุญุฐู ุงูุญุณุงุจ)
- **ุงููุนุงููุงุช**:
  - `userId`: ูุนุฑู ุงููุณุชุฎุฏู

### 2. Frontend Components

#### `useUserDeletion` Hook
- **ุงููููุน**: `src/hooks/useUserDeletion.ts`
- **ุงููุตู**: Hook ูุฅุฏุงุฑุฉ ุนูููุงุช ุญุฐู ุงููุณุชุฎุฏููู
- **ุงููุธุงุฆู**:
  - `deleteUserCompletely()`: ุญุฐู ุดุงูู
  - `deleteIndividualUserData()`: ุญุฐู ุงูุจูุงูุงุช ููุท
  - `confirmUserDeletion()`: ุชุฃููุฏ ุงูุญุฐู

#### `DeleteUserDialog` Component
- **ุงููููุน**: `src/components/admin/DeleteUserDialog.tsx`
- **ุงููุตู**: ูุงุฌูุฉ ุญูุงุฑ ุญุฐู ุงููุณุชุฎุฏู
- **ุงููููุฒุงุช**:
  - ุชุฃููุฏ ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู
  - ุฎูุงุฑุงุช ุญุฐู ูุชุนุฏุฏุฉ
  - ุชุญุฐูุฑุงุช ููุฃุฏูุงุฑ ุงููููุฉ

## ๐๏ธ ุงูุจูุงูุงุช ุงููุญุฐููุฉ

### ูููุณุชุฎุฏููู ุงูุฃูุฑุงุฏ (`individual`)
1. **ุญุณุงุจ Firebase Auth** (ุงุฎุชูุงุฑู)
2. **ูุฌููุนุฉ `users`** - ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
3. **ูุฌููุนุฉ `individuals`** - ุจูุงูุงุช ุฅุถุงููุฉ
4. **ุงููุฌููุนุงุช ุงููุฑุนูุฉ**:
   - `individuals/{uid}/tasks` (ูุธุงู ูุฏูู)
   - `individuals/{uid}/reports` (ูุธุงู ูุฏูู)
5. **ุงูููุงู ุงูุฑุฆูุณูุฉ** (`tasks` collection)
6. **ุงูุงุฌุชูุงุนุงุช** (ููุดุฃุฉ ุฃู ูุดุงุฑู ูููุง)
7. **ูุฆุงุช ุงูููุงู** ุงูููุดุฃุฉ
8. **ุงูุฅุดุนุงุฑุงุช**
9. **ุฑููุฒ OTP**

### ูููุณุชุฎุฏููู ุงูุชูุธููููู (`organization`)
1. **ุญุณุงุจ Firebase Auth**
2. **ูุฌููุนุฉ `users`** - ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ
3. **ุนุถููุฉ ุงููุคุณุณุฉ** (`organizations/{orgId}/members/{userId}`)
4. **ุงูููุงู** (ููุดุฃุฉ ุฃู ูุนููุฉ)
5. **ุงูุงุฌุชูุงุนุงุช** (ููุดุฃุฉ ุฃู ูุดุงุฑู ูููุง)
6. **ุงูุฃูุฏุงู** (`objectives`)
7. **ุงููุชุงุฆุฌ ุงูุฑุฆูุณูุฉ** (`keyResults`)
8. **ุฑูุงุจุท ุงูููุงู ูุงููุชุงุฆุฌ** (`taskKeyResultLinks`)
9. **ูุฆุงุช ุงูููุงู** ุงูููุดุฃุฉ
10. **ุงูุฅุดุนุงุฑุงุช**
11. **ุฑููุฒ OTP**

## ๐ ุงููููุฏ ุงูุฃูููุฉ

### 1. ุตูุงุญูุงุช ุงููุตูู
- ูุฌุจ ุฃู ูููู ุงููุณุชุฏุนู **ูุฏูุฑ ูุธุงู** (`isSystemAdmin` ุฃู `isSystemOwner`)
- ูุง ูููู ูููุณุชุฎุฏู ุญุฐู ููุณู
- ูููุณุชุฎุฏููู ุงูุฃูุฑุงุฏ: ูููู ูููุณุชุฎุฏู ุญุฐู ุจูุงูุงุชู ุงูุฎุงุตุฉ ููุท

### 2. ูููุฏ ุงูุฃุฏูุงุฑ ุงููููุฉ
- **ูุงูู ุงููุคุณุณุฉ** (`isOrgOwner`): ูุชุทูุจ `forceDelete` ุฃู ูุฌูุฏ ูุฏูุฑ ุขุฎุฑ
- **ูุงูู ุงููุธุงู** (`isSystemOwner`): ูุชุทูุจ `forceDelete`

### 3. ุงูุชุญูู ูู ุงูุชุฃููุฏ
- ูุฌุจ ุฅุฏุฎุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูููุณุชุฎุฏู ููุชุฃููุฏ
- ุนุฑุถ ุชุญุฐูุฑุงุช ูุงุถุญุฉ ูุจู ุงูุญุฐู

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ูู ุงูููุฏ (Hook)
```typescript
import { useUserDeletion } from '@/hooks/useUserDeletion';

const { deleteUserCompletely, isDeleting } = useUserDeletion();

// ุญุฐู ุดุงูู
await deleteUserCompletely(userId, forceDelete);

// ุญุฐู ุงูุจูุงูุงุช ููุท (ููุฃูุฑุงุฏ)
await deleteIndividualUserData(userId);
```

### 2. ูู ุงููุงุฌูุฉ (Component)
```tsx
import { DeleteUserDialog } from '@/components/admin/DeleteUserDialog';

<DeleteUserDialog
  isOpen={isDialogOpen}
  onClose={() => setIsDialogOpen(false)}
  user={selectedUser}
  onUserDeleted={handleUserDeleted}
/>
```

### 3. ุงุณุชุฏุนุงุก ูุจุงุดุฑ (Firebase Functions)
```typescript
import { httpsCallable } from 'firebase/functions';

const deleteUserFn = httpsCallable(functions, 'deleteUserCompletely');
const result = await deleteUserFn({
  userId: 'user-id',
  forceDelete: false
});
```

## โ๏ธ ุชุญุฐูุฑุงุช ูููุฉ

1. **ูุง ูููู ุงูุชุฑุงุฌุน**: ุนูููุฉ ุงูุญุฐู ููุงุฆูุฉ ููุง ูููู ุงูุชุฑุงุฌุน ุนููุง
2. **ุชุฃุซูุฑ ุนูู ุงูุจูุงูุงุช ุงููุฑุชุจุทุฉ**: ุญุฐู ุงููุณุชุฎุฏู ูุคุซุฑ ุนูู ุฌููุน ุงูุจูุงูุงุช ุงููุฑุชุจุทุฉ
3. **ุงูุฃุฏูุงุฑ ุงููููุฉ**: ุญุฐู ูุงูู ุงููุคุณุณุฉ ูุฏ ูุคุซุฑ ุนูู ุงููุคุณุณุฉ ุจุงููุงูู
4. **ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ**: ุชุฃูุฏ ูู ูุฌูุฏ ูุณุฎ ุงุญุชูุงุทูุฉ ูุจู ุงูุญุฐู

## ๐ง ุงูุชุฎุตูุต ูุงูุชุทููุฑ

### ุฅุถุงูุฉ ูุฌููุนุงุช ุฌุฏูุฏุฉ ููุญุฐู
1. ุฃุถู ุงูุงุณุชุนูุงู ูู `deleteUserCompletely`
2. ุญุฏุซ `DeleteUserResult` interface
3. ุฃุถู ุงูุนุฏุงุฏ ูู `deletedData`

### ุชุฎุตูุต ุงูุชุญุฐูุฑุงุช
1. ุนุฏูู `DeleteUserDialog` component
2. ุฃุถู ุดุฑูุท ุฌุฏูุฏุฉ ูู `deleteUserCompletely`
3. ุญุฏุซ ุฑุณุงุฆู ุงูุชุญุฐูุฑ

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

- ุฌููุน ุงูุนูููุงุช ูุณุฌูุฉ ูู console
- ุนุฑุถ ุชูุฏู ุงูุนูููุฉ ูููุณุชุฎุฏู
- ุฅุญุตุงุฆูุงุช ููุตูุฉ ุนู ุงูุจูุงูุงุช ุงููุญุฐููุฉ
- ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุดุงููุฉ

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑ ุงููุญุฏุฉ
```bash
# ุชุดุบูู ุงุฎุชุจุงุฑุงุช Firebase Functions
npm run test:functions

# ุงุฎุชุจุงุฑ ููููุงุช React
npm run test:components
```

### ุงุฎุชุจุงุฑ ุงูุชูุงูู
1. ุฅูุดุงุก ูุณุชุฎุฏู ุชุฌุฑูุจู
2. ุฅุถุงูุฉ ุจูุงูุงุช ูุฑุชุจุทุฉ
3. ุชูููุฐ ุนูููุฉ ุงูุญุฐู
4. ุงูุชุญูู ูู ุญุฐู ุฌููุน ุงูุจูุงูุงุช

## ๐ ุณุฌู ุงูุชุบููุฑุงุช

### ุงูุฅุตุฏุงุฑ 1.0.0
- ุฅูุดุงุก ูุธุงู ุญุฐู ุงููุณุชุฎุฏููู ุงูุฃุณุงุณู
- ุฏุนู ุงููุณุชุฎุฏููู ุงูุฃูุฑุงุฏ ูุงูุชูุธููููู
- ูุงุฌูุฉ ูุณุชุฎุฏู ุขููุฉ ูุน ุงูุชุฃููุฏ
- ุญุฐู ุดุงูู ูุฌููุน ุงูุจูุงูุงุช ุงููุฑุชุจุทุฉ
