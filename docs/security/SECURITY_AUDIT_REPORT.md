# ðŸ”’ ØªÙ‚Ø±ÙŠØ± Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ù…Ø§Ù† - Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªØµØ§Ø±ÙŠØ­

**ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:** 2025-01-27
**Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹:** Augment Agent
**Ù†Ø·Ø§Ù‚ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©:** Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©ØŒ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±ØŒ ÙˆØ§Ù„ØªØµØ§Ø±ÙŠØ­
**Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø®Ø·ÙˆØ±Ø©:** Ø¹Ø§Ù„ÙŠ ðŸš¨

---

## ðŸ“‹ Ù…Ù„Ø®Øµ ØªÙ†ÙÙŠØ°ÙŠ

ØªÙ… Ø¥Ø¬Ø±Ø§Ø¡ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„Ø£Ù…Ø§Ù† ÙÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚. ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø¹Ø¯Ø© Ù…Ø´Ø§ÙƒÙ„ Ø£Ù…Ù†ÙŠØ© ØªØªØ±Ø§ÙˆØ­ Ù…Ù† Ù…ØªÙˆØ³Ø·Ø© Ø¥Ù„Ù‰ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø®Ø·ÙˆØ±Ø© ØªØªØ·Ù„Ø¨ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ÙÙˆØ±ÙŠØ©.

### Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©:
- âœ… **Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©:** Ù‡ÙŠÙƒÙ„ Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Firebase
- âš ï¸ **Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…ØªÙˆØ³Ø·Ø©:** 5 Ù…Ø´Ø§ÙƒÙ„ ØªØªØ·Ù„Ø¨ Ø¥ØµÙ„Ø§Ø­
- ðŸš¨ **Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¹Ø§Ù„ÙŠØ©:** 3 Ù…Ø´Ø§ÙƒÙ„ Ø­Ø±Ø¬Ø© ØªØªØ·Ù„Ø¨ Ø¥Ø¬Ø±Ø§Ø¡ ÙÙˆØ±ÙŠ

**Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 6.5/10**

---

## ðŸ—ï¸ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹

### 1. Firebase Authentication
- **Ø§Ù„ÙˆØ¸ÙŠÙØ©:** Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
- **Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** UIDØŒ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±
- **Ø§Ù„Ø­Ø§Ù„Ø©:** âœ… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­

### 2. Custom Claims
- **Ø§Ù„ÙˆØ¸ÙŠÙØ©:** ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
- **Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** Ø§Ù„Ø£Ø¯ÙˆØ§Ø±ØŒ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§ØªØŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø©
- **Ø§Ù„Ø­Ø§Ù„Ø©:** âš ï¸ ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†

### 3. Firestore Database
- **Ø§Ù„ÙˆØ¸ÙŠÙØ©:** ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
- **Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ØŒ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§ØªØŒ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠØ©
- **Ø§Ù„Ø­Ø§Ù„Ø©:** âœ… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯

---

## ðŸ” Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…ÙƒØªØ´ÙØ©

### ðŸš¨ Ù…Ø´Ø§ÙƒÙ„ Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø®Ø·ÙˆØ±Ø©

#### 1. Ø³ÙŠØ§Ø³Ø© ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø¶Ø¹ÙŠÙØ©
**Ø§Ù„Ù…Ù„Ù:** `src/app/(auth)/signup/page.tsx`
```typescript
password: z.string().min(6, { message: t('auth.passwordMinLength', { length: '6' }) })
```
**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:** ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØªØªØ·Ù„Ø¨ 6 Ø£Ø­Ø±Ù ÙÙ‚Ø·
**Ø§Ù„Ø®Ø·ÙˆØ±Ø©:** ðŸš¨ Ø¹Ø§Ù„ÙŠØ©
**Ø§Ù„ØªØ£Ø«ÙŠØ±:** Ø³Ù‡ÙˆÙ„Ø© Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª

#### 2. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª CORS ØºÙŠØ± Ø¢Ù…Ù†Ø©
**Ø§Ù„Ù…Ù„Ù:** `functions/src/shared/function-utils.ts`
```typescript
export const corsHandler = cors({ origin: true });
```
**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:** Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØµØ§Ø¯Ø± Ø¨Ø§Ù„ÙˆØµÙˆÙ„
**Ø§Ù„Ø®Ø·ÙˆØ±Ø©:** ðŸš¨ Ø¹Ø§Ù„ÙŠØ©
**Ø§Ù„ØªØ£Ø«ÙŠØ±:** Ù‡Ø¬Ù…Ø§Øª CSRF Ù…Ø­ØªÙ…Ù„Ø©

#### 3. ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© Ø¨Ø¯ÙˆÙ† ØªØ´ÙÙŠØ±
**Ø§Ù„Ù…Ù„Ù:** `src/app/api/debug/verify-otp/route.ts`
```typescript
where('otp', '==', otp)
```
**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:** ØªØ®Ø²ÙŠÙ† OTP Ø¨Ø¯ÙˆÙ† ØªØ´ÙÙŠØ±
**Ø§Ù„Ø®Ø·ÙˆØ±Ø©:** ðŸš¨ Ø¹Ø§Ù„ÙŠØ©
**Ø§Ù„ØªØ£Ø«ÙŠØ±:** Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø³Ø±ÙŠØ©

### âš ï¸ Ù…Ø´Ø§ÙƒÙ„ Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ø®Ø·ÙˆØ±Ø©

#### 4. Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ù‡Ø¬Ù…Ø§Øª Ø§Ù„Ù…ØªÙƒØ±Ø±Ø©
**Ø§Ù„Ù…Ù„Ù:** `src/components/debug/DebugAuthDialog.tsx`
```typescript
if (attempts >= 3) {
  toast({ title: 'ØªØ­Ø°ÙŠØ± Ø£Ù…Ù†ÙŠ' });
}
```
**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:** Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø¸Ø± ÙØ¹Ù„ÙŠ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
**Ø§Ù„Ø®Ø·ÙˆØ±Ø©:** âš ï¸ Ù…ØªÙˆØ³Ø·Ø©
**Ø§Ù„ØªØ£Ø«ÙŠØ±:** Ù‡Ø¬Ù…Ø§Øª brute force Ù…Ø­ØªÙ…Ù„Ø©

#### 5. ÙƒØ´Ù Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø³Ø© ÙÙŠ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£
**Ø§Ù„Ù…Ù„Ù:** `functions/src/auth/auth.ts`
```typescript
console.error(`User ${decodedToken.uid} is not an owner or admin`);
```
**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:** ÙƒØ´Ù Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„Ø³Ø¬Ù„Ø§Øª
**Ø§Ù„Ø®Ø·ÙˆØ±Ø©:** âš ï¸ Ù…ØªÙˆØ³Ø·Ø©
**Ø§Ù„ØªØ£Ø«ÙŠØ±:** ØªØ³Ø±ÙŠØ¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø­Ø³Ø§Ø³Ø©

---

## ðŸ‘¤ ØªØ­Ù„ÙŠÙ„ Ø­Ø§Ù„Ø© Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø­Ø¯Ø¯

### Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:
- **Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:** tarf4657@gmail.com
- **Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:** 0sDSE4moeIbOxMWFkMWu...
- **Ù†ÙˆØ¹ Ø§Ù„Ø­Ø³Ø§Ø¨:** individual
- **Ø§Ù„Ø­Ø§Ù„Ø©:** Ù†Ø´Ø·

### ðŸš¨ Ù…Ø´Ø§ÙƒÙ„ Ù…ÙƒØªØ´ÙØ© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:

#### 1. ØªØ¶Ø§Ø±Ø¨ ÙÙŠ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± (Ø®Ø·ÙŠØ± Ø¬Ø¯Ø§Ù‹)
```json
{
  "role": "system_owner",
  "isSystemOwner": true,
  "isSystemAdmin": true,      // âš ï¸ ØªØ¶Ø§Ø±Ø¨
  "isIndividualAdmin": true,  // âš ï¸ ØªØ¶Ø§Ø±Ø¨
  "isAdmin": true,           // âš ï¸ ØªØ¶Ø§Ø±Ø¨
  "owner": true,
  "admin": true              // âš ï¸ ØªØ¶Ø§Ø±Ø¨
}
```
**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:** Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¯ÙŠÙ‡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹
**Ø§Ù„Ø®Ø·ÙˆØ±Ø©:** ðŸš¨ Ø­Ø±Ø¬Ø©
**Ø§Ù„ØªØ£Ø«ÙŠØ±:** ØµÙ„Ø§Ø­ÙŠØ§Øª Ù…ÙØ±Ø·Ø© ÙˆØºÙŠØ± Ø¢Ù…Ù†Ø©

#### 2. Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± Ù…Ø­Ù‚Ù‚
```json
{
  "email": "tarf4657@gmail.com",
  "emailVerified": false
}
```
**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:** Ø­Ø³Ø§Ø¨ Ø¨ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¹Ø§Ù„ÙŠØ© Ø¨Ø¯ÙˆÙ† ØªØ­Ù‚Ù‚
**Ø§Ù„Ø®Ø·ÙˆØ±Ø©:** âš ï¸ Ù…ØªÙˆØ³Ø·Ø©
**Ø§Ù„ØªØ£Ø«ÙŠØ±:** Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù†ØªØ­Ø§Ù„ Ø§Ù„Ù‡ÙˆÙŠØ©

#### 3. ØªØ¶Ø§Ø±Ø¨ ÙÙŠ ØªÙˆØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ«
```json
{
  "updatedAt": "2025-05-24 21:51:53",
  "updated_at": "2025-05-24 20:29:53"  // ØªØ§Ø±ÙŠØ® Ù…Ø®ØªÙ„Ù
}
```
**Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:** Ø¹Ø¯Ù… ØªØ²Ø§Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
**Ø§Ù„Ø®Ø·ÙˆØ±Ø©:** âš ï¸ Ù…Ù†Ø®ÙØ¶Ø©
**Ø§Ù„ØªØ£Ø«ÙŠØ±:** Ù…Ø´Ø§ÙƒÙ„ ÙÙŠ ØªØªØ¨Ø¹ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª

---

## ðŸ“Š ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…Ø¬Ø§Ù„Ø§Øª

| Ø§Ù„Ù…Ø¬Ø§Ù„ | Ø§Ù„ØªÙ‚ÙŠÙŠÙ… | Ø§Ù„Ø¯Ø±Ø¬Ø© | Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª |
|---------|---------|--------|-----------|
| Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© | Ø¬ÙŠØ¯ | 8/10 | Ù†Ø¸Ø§Ù… Ù…ØªÙ‚Ø¯Ù… ÙˆÙ…ØªÙƒØ§Ù…Ù„ |
| Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ù…Ø§Ù† | Ù…Ù…ØªØ§Ø² | 9/10 | Firestore Rules Ø´Ø§Ù…Ù„Ø© |
| Ø¥Ø¯Ø§Ø±Ø© ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± | Ø¶Ø¹ÙŠÙ | 4/10 | ØªØªØ·Ù„Ø¨ ØªØ­Ø³ÙŠÙ† ÙÙˆØ±ÙŠ |
| Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ù‡Ø¬Ù…Ø§Øª | Ù…ØªÙˆØ³Ø· | 5/10 | ØªØ­ØªØ§Ø¬ rate limiting |
| ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª | Ø¶Ø¹ÙŠÙ | 3/10 | Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø§Ø³Ø© ØºÙŠØ± Ù…Ø´ÙØ±Ø© |
| Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ | Ù…ØªÙˆØ³Ø· | 6/10 | ØªØ­Ø³ÙŠÙ† Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£ |
| ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« | Ø¬ÙŠØ¯ | 7/10 | Ù†Ø¸Ø§Ù… Ø³Ø¬Ù„Ø§Øª Ù…ØªÙ‚Ø¯Ù… |

---

## ðŸ› ï¸ Ø§Ù„ØªÙˆØµÙŠØ§Øª ÙˆØ§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª

### ðŸš¨ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ÙÙˆØ±ÙŠØ© (Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©)

#### 1. Ø¥ØµÙ„Ø§Ø­ Ø³ÙŠØ§Ø³Ø© ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±
```typescript
const passwordSchema = z.string()
  .min(8, 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† 8 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„')
  .regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])/,
    'ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø­Ø±Ù ÙƒØ¨ÙŠØ± ÙˆØµØºÙŠØ± ÙˆØ±Ù‚Ù… ÙˆØ±Ù…Ø² Ø®Ø§Øµ');
```

#### 2. ØªÙ‚ÙŠÙŠØ¯ CORS
```typescript
const corsHandler = cors({
  origin: ['https://yourdomain.com'],
  credentials: true,
  optionsSuccessStatus: 200
});
```

#### 3. ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©
```typescript
import crypto from 'crypto';

const hashOTP = (otp: string) => {
  return crypto.createHash('sha256').update(otp).digest('hex');
};
```

### âš ï¸ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ø¯Ù‰ (Ø®Ù„Ø§Ù„ Ø£Ø³Ø¨ÙˆØ¹)

#### 4. Ø¥Ø¶Ø§ÙØ© Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ù‡Ø¬Ù…Ø§Øª Ø§Ù„Ù…ØªÙƒØ±Ø±Ø©
```typescript
const MAX_ATTEMPTS = 5;
const LOCKOUT_TIME = 15 * 60 * 1000; // 15 Ø¯Ù‚ÙŠÙ‚Ø©

const rateLimiter = new Map();
```

#### 5. ØªØ­Ø³ÙŠÙ† Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
```typescript
res.status(403).json({
  error: 'ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„',
  code: 'INSUFFICIENT_PERMISSIONS'
});
```

### ðŸ“ˆ ØªØ­Ø³ÙŠÙ†Ø§Øª Ø·ÙˆÙŠÙ„Ø© Ø§Ù„Ù…Ø¯Ù‰ (Ø®Ù„Ø§Ù„ Ø´Ù‡Ø±)

#### 6. Ø¥Ø¶Ø§ÙØ© ØªØ³Ø¬ÙŠÙ„ Ø£Ù…Ù†ÙŠ Ø´Ø§Ù…Ù„
```typescript
const logSecurityEvent = async (event: string, userId: string) => {
  await addDoc(collection(db, 'securityLogs'), {
    event, userId, timestamp: serverTimestamp()
  });
};
```

#### 7. ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ù…Ù…ÙŠØ²Ø©
```typescript
const verifyTokenWithExpiry = async (token: string) => {
  const decodedToken = await admin.auth().verifyIdToken(token, true);
  if (decodedToken.exp * 1000 < Date.now()) {
    throw new Error('Token expired');
  }
  return decodedToken;
};
```

---

## ðŸ”§ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø´ÙƒÙˆÙƒ ÙÙŠÙ‡

### Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ÙÙˆØ±ÙŠ:

#### 1. ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø£Ø¯ÙˆØ§Ø±
```typescript
const correctClaims = {
  role: "system_owner",
  accountType: "individual",
  system_owner: true,
  system_admin: false,
  organization_owner: false,
  admin: false,
  owner: true,
  individual_admin: false
};

await admin.auth().setCustomUserClaims(uid, correctClaims);
```

#### 2. ØªØ­Ø¯ÙŠØ« Firestore
```typescript
await db.collection('users').doc(uid).update({
  role: "system_owner",
  isSystemOwner: true,
  isSystemAdmin: false,
  isAdmin: false,
  updatedAt: serverTimestamp()
});
```

#### 3. ÙØ±Ø¶ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ
```typescript
await sendEmailVerification(user);
```

---

## ðŸ“… Ø¬Ø¯ÙˆÙ„ Ø²Ù…Ù†ÙŠ Ù„Ù„ØªÙ†ÙÙŠØ°

| Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© | Ø§Ù„Ù…Ù‡Ù…Ø© | Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© | Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ |
|----------|--------|-------------|---------|
| ðŸš¨ Ø¹Ø§Ø¬Ù„ | Ø¥ØµÙ„Ø§Ø­ ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± | 24 Ø³Ø§Ø¹Ø© | ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ± |
| ðŸš¨ Ø¹Ø§Ø¬Ù„ | ØªÙ‚ÙŠÙŠØ¯ CORS | 24 Ø³Ø§Ø¹Ø© | ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ± |
| ðŸš¨ Ø¹Ø§Ø¬Ù„ | ØªØ´ÙÙŠØ± OTP | 48 Ø³Ø§Ø¹Ø© | ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ± |
| âš ï¸ Ù…Ù‡Ù… | Rate Limiting | Ø£Ø³Ø¨ÙˆØ¹ | ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ± |
| âš ï¸ Ù…Ù‡Ù… | ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ | Ø£Ø³Ø¨ÙˆØ¹ | ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ± |
| ðŸ“ˆ ØªØ­Ø³ÙŠÙ† | Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ© | Ø´Ù‡Ø± | ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ù…Ø§Ù† |

---

## ðŸ“ž Ø¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„

**ÙØ±ÙŠÙ‚ Ø§Ù„Ø£Ù…Ø§Ù†:** security@company.com
**ÙØ±ÙŠÙ‚ Ø§Ù„ØªØ·ÙˆÙŠØ±:** dev@company.com
**Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‚Ù†ÙŠØ©:** cto@company.com

---

## ðŸ“ Ø§Ù„Ø®Ù„Ø§ØµØ©

Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø³Ø§Ø³ Ù‚ÙˆÙŠ Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„Ø£Ù…Ø§Ù†ØŒ Ù„ÙƒÙ†Ù‡ ÙŠØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥ØµÙ„Ø§Ø­Ø§Øª ÙÙˆØ±ÙŠØ© ÙÙŠ Ø¹Ø¯Ø© Ù…Ø¬Ø§Ù„Ø§Øª Ø­Ø±Ø¬Ø©. Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ø³Ø±ÙŠØ¹ Ù„Ù„ØªÙˆØµÙŠØ§Øª Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© Ø³ÙŠØ­Ø³Ù† Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø£Ù…Ø§Ù† Ø¨Ø´ÙƒÙ„ ÙƒØ¨ÙŠØ±.

**Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ø§Ù„Ù‚ØµÙˆÙ‰:** Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø°Ùˆ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ÙØ±Ø·Ø© ÙˆØªØ­Ø³ÙŠÙ† Ø³ÙŠØ§Ø³Ø© ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±.

---

## ðŸ“‹ Ù…Ù„Ø§Ø­Ù‚

### Ù…Ù„Ø­Ù‚ Ø£: Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©
- `src/context/AuthContext.tsx` - Ø³ÙŠØ§Ù‚ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
- `firestore.rules` - Ù‚ÙˆØ§Ø¹Ø¯ Ø£Ù…Ø§Ù† Firestore
- `functions/src/auth/auth.ts` - ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©
- `src/app/(auth)/signup/page.tsx` - ØµÙØ­Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
- `src/app/(auth)/login/page.tsx` - ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
- `functions/src/shared/function-utils.ts` - Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
- `src/components/debug/DebugAuthDialog.tsx` - Ù…ÙƒÙˆÙ† Ø§Ù„ØªØ´Ø®ÙŠØµ
- `src/hooks/useFirebaseAuth.ts` - Ø®Ø·Ø§Ù Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©

### Ù…Ù„Ø­Ù‚ Ø¨: Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
- **ØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø«Ø§Ø¨Øª:** Ù…Ø±Ø§Ø¬Ø¹Ø© ÙŠØ¯ÙˆÙŠØ© Ù„Ù„ÙƒÙˆØ¯
- **ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:** ÙØ­Øµ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
- **Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ù…Ø§Ù†:** ÙØ­Øµ Ù‚ÙˆØ§Ø¹Ø¯ Firestore
- **Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø«ØºØ±Ø§Øª:** Ù…Ø­Ø§ÙƒØ§Ø© Ù‡Ø¬Ù…Ø§Øª Ù…Ø­ØªÙ…Ù„Ø©

### Ù…Ù„Ø­Ù‚ Ø¬: Ù…Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø£Ù…Ø§Ù†
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Firebase Security Best Practices](https://firebase.google.com/docs/rules/security)
- [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)

### Ù…Ù„Ø­Ù‚ Ø¯: Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø³Ø±ÙŠØ¹
```bash
# ØªØ´ØºÙŠÙ„ Ø³ÙƒØ±ÙŠØ¨Øª Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø´ÙƒÙˆÙƒ ÙÙŠÙ‡
npm run fix-user-roles -- --uid=0sDSE4moeIbOxMWFkMWu...

# ØªØ­Ø¯ÙŠØ« Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ù…Ø§Ù†
firebase deploy --only firestore:rules

# ØªØ­Ø¯ÙŠØ« Cloud Functions
firebase deploy --only functions
```

### Ù…Ù„Ø­Ù‚ Ù‡Ù€: Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ù‚ØªØ±Ø­Ø©
- Ø¹Ø¯Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø§Øª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ§Ø´Ù„Ø©
- Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø°ÙˆÙˆ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ØªØ¹Ø¯Ø¯Ø©
- Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø­Ù‚Ù‚Ø© Ø¨ØµÙ„Ø§Ø­ÙŠØ§Øª Ø¹Ø§Ù„ÙŠØ©
- Ø§Ø³ØªØ®Ø¯Ø§Ù… OTP ÙˆØ§Ù„Ø±Ù…ÙˆØ² Ø§Ù„Ø£Ù…Ù†ÙŠØ©
- Ø£Ù†Ø´Ø·Ø© Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠÙ† ØºÙŠØ± Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©

---

## ðŸ”„ ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ØªÙ‚Ø±ÙŠØ±

| Ø§Ù„ØªØ§Ø±ÙŠØ® | Ø§Ù„Ù†Ø³Ø®Ø© | Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª |
|---------|---------|-----------|
| 2025-01-27 | 1.0 | Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£ÙˆÙ„ÙŠ |
| - | - | - |
| - | - | - |

---

## âœ… Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©

- [ ] Ø¥ØµÙ„Ø§Ø­ Ø³ÙŠØ§Ø³Ø© ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ±
- [ ] ØªÙ‚ÙŠÙŠØ¯ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª CORS
- [ ] ØªØ´ÙÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø©
- [ ] Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø´ÙƒÙˆÙƒ ÙÙŠÙ‡
- [ ] Ø¥Ø¶Ø§ÙØ© Rate Limiting
- [ ] ØªØ­Ø³ÙŠÙ† Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø®Ø·Ø£
- [ ] ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø£Ù…Ù†ÙŠØ©
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª
- [ ] ØªØ¯Ø±ÙŠØ¨ Ø§Ù„ÙØ±ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù…Ø§Ø±Ø³Ø§Øª Ø§Ù„Ø¢Ù…Ù†Ø©
- [ ] ÙˆØ¶Ø¹ Ø®Ø·Ø© Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…Ø³ØªÙ…Ø±Ø©

---

*ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© Augment Agent - 2025-01-27*
*Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«: 2025-01-27 | Ø§Ù„Ù†Ø³Ø®Ø©: 1.0*
