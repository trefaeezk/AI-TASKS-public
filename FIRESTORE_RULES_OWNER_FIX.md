# ุฅุตูุงุญ ููุงุนุฏ Firestore ูุฏุนู ุฃุตุญุงุจ ุงููุคุณุณุงุช

## ุงููุดููุฉ ุงููุญูููุฉ โ

ูุงู ุงููุณุชุฎุฏู ุตุงุญุจ ุงููุคุณุณุฉ (`isAdmin: true`) ูุง ููููู ุงููุตูู ูุจูุงูุงุช ุงููุคุณุณุฉ ุจุณุจุจ:

1. **ููุงุนุฏ Firestore ูู ุชุฏุนู ุฃุตุญุงุจ ุงููุคุณุณุงุช**: ุงูููุงุนุฏ ูุงูุช ุชุชุญูู ููุท ูู ุงูุนุถููุฉ ูู `members`
2. **ุนุฏู ุฌูุจ ุจูุงูุงุช ุงููุคุณุณุฉ**: ุงูููุฏ ูู ููู ูุฌูุจ ูุซููุฉ ุงููุคุณุณุฉ ููุชุญูู ูู `ownerId`
3. **ููุงุนุฏ ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช ููููุฏุฉ**: ูู ุชูู ููุงู ููุงุนุฏ ูู `notificationSettings`

## ุงูุญููู ุงููุทุจูุฉ ๐ง

### 1. **ุชุญุฏูุซ ููุงุนุฏ Firestore** ๐

#### **ูุจู ุงูุฅุตูุงุญ**:
```javascript
// ููุงุนุฏ ุงููุคุณุณุงุช - ุชุชุญูู ููุท ูู ุงูุนุถููุฉ
allow read: if request.auth != null && (
  exists(/databases/.../organizations/{orgId}/members/{userId}) ||
  request.auth.token.admin == true
);
```

#### **ุจุนุฏ ุงูุฅุตูุงุญ**:
```javascript
// ููุงุนุฏ ุงููุคุณุณุงุช - ุชุฏุนู ุฃุตุญุงุจ ุงููุคุณุณุงุช
allow read: if request.auth != null && (
  // ุตุงุญุจ ุงููุคุณุณุฉ
  resource.data.ownerId == request.auth.uid ||
  // ุนุถู ูู ุงููุคุณุณุฉ
  exists(/databases/.../organizations/{orgId}/members/{userId}) ||
  // ุฃุฏูู ุงููุธุงู
  request.auth.token.admin == true
);
```

### 2. **ุฅุถุงูุฉ ููุงุนุฏ ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช** ๐

```javascript
// ููุงุนุฏ ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช
match /notificationSettings/{userId} {
  allow read, write: if request.auth != null && (
    request.auth.uid == userId ||
    request.auth.token.admin == true
  );
}
```

### 3. **ุชุญุฏูุซ ููุงุนุฏ ุงูููุงู ูุฏุนู ุฃุตุญุงุจ ุงููุคุณุณุงุช** ๐

#### **ูุจู**:
```javascript
// ููุงู ุงููุคุณุณุฉ - ุนุถููุฉ ููุท
(resource.data.organizationId != null && 
 exists(/databases/.../organizations/{orgId}/members/{userId}))
```

#### **ุจุนุฏ**:
```javascript
// ููุงู ุงููุคุณุณุฉ - ุตุงุญุจ ุงููุคุณุณุฉ + ุงูุนุถููุฉ
(resource.data.organizationId != null && (
  // ุตุงุญุจ ุงููุคุณุณุฉ
  get(/databases/.../organizations/{orgId}).data.ownerId == request.auth.uid ||
  // ุนุถู ูู ุงููุคุณุณุฉ
  exists(/databases/.../organizations/{orgId}/members/{userId})
))
```

### 4. **ุชุญุฏูุซ ููุฏ ุฌูุจ ุงูุจูุงูุงุช** ๐ป

#### **ุฅุถุงูุฉ ุฌูุจ ุจูุงูุงุช ุงููุคุณุณุฉ**:
```typescript
// ุฌูุจ ุจูุงูุงุช ุงููุคุณุณุฉ ุฃููุงู ููุชุญูู ูู ุงูุตูุงุญูุงุช
const orgDoc = await getDoc(doc(db, 'organizations', organizationId));
if (!orgDoc.exists()) {
  throw new Error('Organization not found');
}

const orgData = orgDoc.data();
console.log('Organization data:', orgData);
console.log('Current user ID:', user.uid);
console.log('Organization owner ID:', orgData.ownerId);
```

#### **ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**:
```typescript
// ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุตูุงุญูุงุช
if (error.code === 'permission-denied') {
  toast({
    title: 'ุฎุทุฃ ูู ุงูุตูุงุญูุงุช',
    description: 'ููุณ ูุฏูู ุตูุงุญูุฉ ูููุตูู ุฅูู ุจูุงูุงุช ูุฐู ุงููุคุณุณุฉ.',
    variant: 'destructive',
  });
}
```

## ุงูููุงุนุฏ ุงูุฌุฏูุฏุฉ ุงูุดุงููุฉ ๐

### **ูููู ุงูุตูุงุญูุงุช**:

1. **ุฃุตุญุงุจ ุงููุคุณุณุงุช** (`ownerId`):
   - ุงููุตูู ุงููุงูู ูุจูุงูุงุช ุงููุคุณุณุฉ
   - ุฅูุดุงุก ูุชุนุฏูู ูุญุฐู ุงูููุงู
   - ุฅุฏุงุฑุฉ ุงูุฃุนุถุงุก ูุงูุฃูุณุงู

2. **ุฃุนุถุงุก ุงููุคุณุณุฉ** (`members`):
   - ุงููุตูู ููุจูุงูุงุช ุญุณุจ ุงูุฏูุฑ
   - ุฅูุดุงุก ูุชุนุฏูู ุงูููุงู
   - ุนุฑุถ ุงูุชูุงุฑูุฑ

3. **ุฃุฏูู ุงููุธุงู** (`admin: true`):
   - ุงููุตูู ุงููุงูู ูุฌููุน ุงูุจูุงูุงุช
   - ุฅุฏุงุฑุฉ ุฌููุน ุงููุคุณุณุงุช
   - ุตูุงุญูุงุช ุนููุง

### **ุฃููููุฉ ุงูุตูุงุญูุงุช**:
```
1. ุฃุฏูู ุงููุธุงู (ุฃุนูู ุฃููููุฉ)
2. ุตุงุญุจ ุงููุคุณุณุฉ
3. ุฃุนุถุงุก ุงููุคุณุณุฉ
4. ููุดุฆ ุงููุญุชูู (ููููุงู ูุงูุชูุงุฑูุฑ)
```

## ุงูููุงุฆุฏ ุงูุฌุฏูุฏุฉ ๐

### โ **ุฏุนู ูุงูู ูุฃุตุญุงุจ ุงููุคุณุณุงุช**:
- ูุง ุญุงุฌุฉ ูุฅูุดุงุก ุนุถููุฉ ูู `members`
- ูุตูู ูุจุงุดุฑ ุนุจุฑ `ownerId`
- ุตูุงุญูุงุช ูุงููุฉ ุชููุงุฆูุงู

### โ **ุฃูุงู ูุญุณู**:
- ุงูุชุญูู ูู ุงููููุฉ ุนูู ูุณุชููุงุช ูุชุนุฏุฏุฉ
- ุญูุงูุฉ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
- ููุน ุงููุตูู ุบูุฑ ุงููุตุฑุญ

### โ **ูุฑููุฉ ูู ุงูุฅุฏุงุฑุฉ**:
- ุฏุนู ุงูุฃุฏูุงุฑ ุงููุฎุชููุฉ
- ุตูุงุญูุงุช ูุฎุตุตุฉ ููุฃุนุถุงุก
- ุฅุฏุงุฑุฉ ูุฑูุฉ ูููุญุชูู

### โ **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู**:
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ
- ุชุญููู ุณุฑูุน ููุจูุงูุงุช
- ูุงุฌูุฉ ูุชุฌุงูุจุฉ

## ุงุฎุชุจุงุฑ ุงููุธุงู ๐งช

### **ุฎุทูุงุช ุงูุชุญูู**:

1. **ุตุงุญุจ ุงููุคุณุณุฉ**:
   ```bash
   โ ููููู ุงููุตูู ูููุญุฉ ุงูุชุญูู
   โ ูุฑู ุฅุญุตุงุฆูุงุช ุงููุคุณุณุฉ
   โ ููููู ุฅุฏุงุฑุฉ ุงูููุงู
   โ ููููู ุนุฑุถ ุงูุชูุงุฑูุฑ
   ```

2. **ุนุถู ุงููุคุณุณุฉ**:
   ```bash
   โ ููููู ุงููุตูู ููุจูุงูุงุช ุงููุณููุญุฉ
   โ ููููู ุฅูุดุงุก ููุงู
   โ ูุง ููููู ุญุฐู ููุงู ุงูุขุฎุฑูู (ุฅูุง ุฅุฐุง ูุงู admin)
   ```

3. **ูุณุชุฎุฏู ุฎุงุฑุฌู**:
   ```bash
   โ ูุง ููููู ุงููุตูู ูุจูุงูุงุช ุงููุคุณุณุฉ
   โ ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ
   ```

## ุงููุฑุงูุจุฉ ูุงูุชุดุฎูุต ๐

### **ุณุฌูุงุช Console**:
```javascript
console.log('Organization data:', orgData);
console.log('Current user ID:', user.uid);
console.log('Organization owner ID:', orgData.ownerId);
```

### **ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก**:
- ุชูููุฒ ุฃุฎุทุงุก ุงูุตูุงุญูุงุช
- ุฑุณุงุฆู ูููุฏุฉ ูููุณุชุฎุฏู
- ุณุฌูุงุช ููุตูุฉ ูููุทูุฑูู

## ุงููุชูุฌุฉ ุงูููุงุฆูุฉ ๐

ุชู ุฅุตูุงุญ ุฌููุน ูุดุงูู ุงูุตูุงุญูุงุช:

1. **ุฃุตุญุงุจ ุงููุคุณุณุงุช** ูููููู ุงููุตูู ูุจูุงูุงุชูู โ
2. **ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช** ุชุนูู ุจุดูู ุตุญูุญ โ
3. **ููุงุนุฏ ุฃูุงู ุดุงููุฉ** ููุฑูุฉ โ
4. **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุญุณูุฉ** ูุน ุฑุณุงุฆู ูุงุถุญุฉ โ

**ุงููุธุงู ุฌุงูุฒ ููุฅูุชุงุฌ ูุน ุฏุนู ูุงูู ูุฌููุน ุฃููุงุน ุงููุณุชุฎุฏููู!** ๐
